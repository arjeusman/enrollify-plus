<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Signup - Enrollify+</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.4.2/css/all.css">
    <link rel="icon" href="assets/enrollify.png">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.dark.css" />
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <script type="module" src="script/database.js"></script>
</head>

<body onload="isSigned()">
    <div style="height: 100vh;" class="d-flex flex-column align-items-center justify-content-center">
        <form name="signin" style="max-width: 350px;" method="post" action="" class="card text-bg-white border-0 rounded-2 overflow-hidden needs-validation w-100" novalidate>
            <div style="height: 150px;" class="card-header bg-dark bg-gradient py-4 border-0 rounded-0 d-flex align-items-center justify-content-center">
                <img style="width: 150px;" src="assets/enrollify-white.png">
            </div>
            <div class="card-body">
                <label for="firstname" class="form-label"><i class="fa-solid fa-info-circle"></i> First Name</label>
                <input type="text" id="firstname" name="firstname" class="form-control form-control-lg mb-2" autocomplete="off" required>
                <label for="email" class="form-label"><i class="fa-solid fa-envelope"></i> Email Address</label>
                <input type="email" id="email" name="email" class="form-control form-control-lg mb-2" autocomplete="off" required>
                <label for="password" class="form-label"><i class="fa-solid fa-unlock"></i> Password</label>
                <input type="password" id="password" name="password" class="form-control form-control-lg mb-2" autocomplete="off" required>
                <label for="confirm_password" class="form-label"><i class="fa-solid fa-lock"></i> Confirm Password</label>
                <input oninput="checkPassword(password, confirm_password)" type="password" id="confirm_password" name="confirm_password" class="form-control form-control-lg" autocomplete="off" required>
            </div>
            <div class="card-footer bg-light bg-opacity-25 text-center">
                <div class="d-flex flex-row align-items-center justify-content-between">
                    <a style="font-size: 12px;" class="text-muted" href="signin.html">Have account?</a>
                    <button type="submit" name="signup" class="btn btn-lg btn-info bg-gradient">Sign up <i class="fa-solid fa-arrow-right"></i></button>
                </div>
            </div>
        </form>
    </div>
    <script type="text/javascript" src="script/dashboard.js"></script>
    <script type="text/javascript">
        function checkPassword(p1, p2) {
            if (p1.value == p2.value) {
                p2.classList.add('is-valid')
                p2.classList.remove('is-invalid')
            } else {
                p2.classList.add('is-invalid')
                p2.classList.remove('is-valid')
            }
        }
        let form = document.forms.namedItem('signin')
        form.addEventListener('submit', (e) => {
            e.preventDefault()
            let user = {}
            user.id = Date.now()
            user.firstname = form.firstname.value
            user.email = form.email.value
            user.password = form.password.value
            let check = getUserEmail(user.email)
            if (!form.checkValidity()) {
                e.stopPropagation()
            } else {
                if (check == undefined) {
                    if (form.password.value == form.confirm_password.value) {
                        Process('Signing up please wait.')
                        let users = JSON.parse(localStorage.getItem('enrollify_users'))
                        window.setTimeout((e) => {
                            users.push(user)
                            localStorage.setItem('current_user', user.id)
                            localStorage.setItem('enrollify_users', JSON.stringify(users))
                            Redirect('dashboard.html')
                        }, 2000)
                    }
                } else {
                    Swal.fire({
                        icon: 'warning',
                        iconColor: '#f3676e',
                        iconHtml: '<i class="fa-solid fa-bomb"></i>',
                        html: 'Something went wrong!',
                        width: 350,
                        padding: 20,
                        timer: 2000,
                        showConfirmButton: false,
                        showCancelButton: false
                    })
                }
            }
            form.classList.add('was-validated')
        }, false)
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>

</html>